<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chart Maker Example</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Asegúrate de que la URL o la ruta sea correcta para chart-maker -->
    <script src="../dist/chart-maker.js"></script>
    <style>
        #chart-container {
            width: 80%;
            margin: auto;
        }
        canvas {
            max-width: 100%;
        }
    </style>
</head>
<body>
    <div id="chart-container">
        <canvas id="myChart"></canvas>
        <button id="export-png">Export as PNG</button>
        <button id="export-jpeg">Export as JPEG</button>
    </div>

    <script>
        // Verificar si ChartMaker está disponible en window
        console.log('window.ChartMaker:', window.ChartMaker);

        // Asegúrate de que ChartMaker está definido
        const ChartMaker = window.ChartMaker ? window.ChartMaker.ChartMaker : null;

        if (!ChartMaker) {
            console.error('ChartMaker is not available.');
        } else {
            // Selecciona el elemento canvas en tu documento
            const canvas = document.getElementById('myChart');

            // Configura los datos y opciones del gráfico
            const chartConfig = {
                type: 'line',
                data: {
                    labels: ['January', 'February', 'March'],
                    datasets: [{
                        label: 'Sample Dataset',
                        data: [10, 20, 30],
                        borderColor: 'rgba(75, 192, 192, 1)',
                        backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: true,
                        },
                        tooltip: {
                            callbacks: {
                                label: function(tooltipItem) {
                                    return tooltipItem.label + ': ' + tooltipItem.raw;
                                }
                            }
                        }
                    }
                }
            };

            // Crear el gráfico utilizando ChartMaker
            if (canvas) {
                ChartMaker.createChart(canvas, chartConfig);
            } else {
                console.error('Canvas element is missing.');
            }

            // Función para exportar el gráfico a una imagen
            function exportChart(format, quality) {
                if (canvas) {
                    const imageDataURL = ChartMaker.exportChartToImage(canvas, format, quality);

                    // Crear un enlace para descargar la imagen
                    const link = document.createElement('a');
                    link.href = imageDataURL;
                    link.download = `chart.${format.split('/')[1]}`;
                    link.click();
                } else {
                    console.error('Canvas element is missing.');
                }
            }

            // Añadir eventos a los botones para exportar el gráfico
            document.getElementById('export-png').addEventListener('click', () => {
                exportChart('image/png');
            });

            document.getElementById('export-jpeg').addEventListener('click', () => {
                exportChart('image/jpeg', 0.9); // Calidad JPEG de 0.9
            });
        }
    </script>
</body>
</html>
